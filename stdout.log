[06/06 14:13:08][INFO] train_net.py: 600: Train with config:
[06/06 14:13:08][INFO] train_net.py: 601: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'Motionformer',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:13:19][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 14:20:19][INFO] train_net.py: 601: Train with config:
[06/06 14:20:19][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:20:35][INFO] train_net.py: 601: Train with config:
[06/06 14:20:35][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'Motionformer',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:20:38][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 14:22:09][INFO] train_net.py: 601: Train with config:
[06/06 14:22:09][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'Motionformer',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:22:13][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 14:22:33][INFO] train_net.py: 601: Train with config:
[06/06 14:22:33][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:31:23][INFO] train_net.py: 601: Train with config:
[06/06 14:31:23][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:34:16][INFO] train_net.py: 601: Train with config:
[06/06 14:34:16][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:35:42][INFO] train_net.py: 601: Train with config:
[06/06 14:35:42][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:36:27][INFO] train_net.py: 601: Train with config:
[06/06 14:36:27][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:44:37][INFO] train_net.py: 601: Train with config:
[06/06 14:44:37][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:45:16][INFO] train_net.py: 601: Train with config:
[06/06 14:45:16][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:49:41][INFO] train_net.py: 601: Train with config:
[06/06 14:49:41][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 14:51:52][INFO] train_net.py: 601: Train with config:
[06/06 14:51:52][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:11:52][INFO] train_net.py: 601: Train with config:
[06/06 15:11:52][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:12:47][INFO] train_net.py: 601: Train with config:
[06/06 15:12:47][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:14:00][INFO] train_net.py: 601: Train with config:
[06/06 15:14:00][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'COUNT': 7,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:19:56][INFO] train_net.py: 601: Train with config:
[06/06 15:19:56][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': [256, 448],
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:27:59][INFO] train_net.py: 601: Train with config:
[06/06 15:27:59][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:28:16][INFO] train_net.py: 601: Train with config:
[06/06 15:28:16][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:31:49][INFO] train_net.py: 601: Train with config:
[06/06 15:31:49][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': 'CP/k400_motionformer_224_16x4.pyth',
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:31:57][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 15:33:25][INFO] train_net.py: 601: Train with config:
[06/06 15:33:25][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:33:34][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 15:35:02][INFO] train_net.py: 601: Train with config:
[06/06 15:35:02][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:35:58][INFO] train_net.py: 601: Train with config:
[06/06 15:35:58][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:36:07][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 15:37:01][INFO] train_net.py: 601: Train with config:
[06/06 15:37:01][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': True,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 15:37:10][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 16:32:26][INFO] train_net.py: 601: Train with config:
[06/06 16:32:26][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': True,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:32:35][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 16:34:12][INFO] train_net.py: 601: Train with config:
[06/06 16:34:12][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:34:21][INFO] checkpoint.py: 542: Load from given checkpoint file.
[06/06 16:39:33][INFO] train_net.py: 601: Train with config:
[06/06 16:39:33][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:39:42][INFO] checkpoint.py: 543: Load from given checkpoint file.
[06/06 16:40:09][INFO] train_net.py: 601: Train with config:
[06/06 16:40:09][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:40:18][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:41:10][INFO] train_net.py: 601: Train with config:
[06/06 16:41:10][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:41:19][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:41:43][INFO] train_net.py: 601: Train with config:
[06/06 16:41:43][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:41:52][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:50:11][INFO] train_net.py: 601: Train with config:
[06/06 16:50:11][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:50:21][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:53:59][INFO] train_net.py: 601: Train with config:
[06/06 16:53:59][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:54:08][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:54:27][INFO] train_net.py: 601: Train with config:
[06/06 16:54:27][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:54:36][INFO] checkpoint.py: 544: Load from given checkpoint file.
[06/06 16:55:09][INFO] train_net.py: 601: Train with config:
[06/06 16:55:09][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 16:55:18][INFO] checkpoint.py: 546: Load from given checkpoint file.
[06/06 16:55:52][INFO] train_net.py: 601: Train with config:
[06/06 16:55:52][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:00:54][INFO] train_net.py: 601: Train with config:
[06/06 17:00:54][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:25:09][INFO] train_net.py: 601: Train with config:
[06/06 17:25:09][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:28:52][INFO] train_net.py: 601: Train with config:
[06/06 17:28:52][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:29:30][INFO] train_net.py: 601: Train with config:
[06/06 17:29:30][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:38:41][INFO] train_net.py: 601: Train with config:
[06/06 17:38:41][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 17:38:50][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 17:51:49][INFO] train_net.py: 601: Train with config:
[06/06 17:51:49][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 18:19:24][INFO] train_net.py: 601: Train with config:
[06/06 18:19:24][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 18:19:33][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 18:58:28][INFO] train_net.py: 601: Train with config:
[06/06 18:58:28][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 18:58:37][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:05:18][INFO] train_net.py: 601: Train with config:
[06/06 19:05:18][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:05:27][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:12:48][INFO] train_net.py: 601: Train with config:
[06/06 19:12:48][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:12:58][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:13:11][INFO] train_net.py: 601: Train with config:
[06/06 19:13:11][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:13:20][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:18:05][INFO] train_net.py: 601: Train with config:
[06/06 19:18:05][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 3,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:18:13][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:29:35][INFO] train_net.py: 601: Train with config:
[06/06 19:29:35][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 4,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:29:43][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:29:44][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 19:29:44][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 19:29:44][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 19:29:51][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 19:29:54][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 19:29:54][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 19:29:56][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 19:30:01][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 19:30:01][INFO] train_net.py: 649: Start epoch: 1
[06/06 19:43:46][INFO] train_net.py: 601: Train with config:
[06/06 19:43:46][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/saurav/datasets/CholecT50',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/gamir/DER-Roei/datasets/smthsmth/frames',
          'PATH_TO_DATA_DIR': '/home/saurav/datasets/CholecT50',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 19:43:54][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 19:43:55][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 19:43:55][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 19:43:55][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 19:43:56][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 19:43:56][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 19:43:56][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 19:43:56][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 19:43:57][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 19:43:57][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:28:18][INFO] train_net.py: 601: Train with config:
[06/06 20:28:18][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:28:26][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 20:28:26][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:28:26][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 20:28:27][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:28:27][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:28:28][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:28:28][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:28:28][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:28:29][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:28:29][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:29:32][INFO] train_net.py: 601: Train with config:
[06/06 20:29:32][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:29:41][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 20:29:41][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:29:41][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 20:29:41][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:29:42][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:29:43][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:29:43][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:29:43][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:29:43][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:29:43][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:30:02][INFO] train_net.py: 601: Train with config:
[06/06 20:30:02][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:30:12][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 20:30:12][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:30:12][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 20:30:13][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:30:14][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:30:14][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:30:14][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:30:14][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:30:15][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:30:15][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:30:56][INFO] train_net.py: 601: Train with config:
[06/06 20:30:56][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:31:04][INFO] cholec80.py:  46: Constructing Cholec80 train...
[06/06 20:31:05][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:31:05][INFO] cholec80.py:  46: Constructing Cholec80 val...
[06/06 20:31:05][INFO] cholec80.py:  68: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:31:06][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:31:07][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:31:07][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:31:07][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:31:07][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:31:07][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:32:13][INFO] train_net.py: 601: Train with config:
[06/06 20:32:13][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:32:21][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/06 20:32:22][INFO] cholec80.py:  69: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:32:22][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/06 20:32:22][INFO] cholec80.py:  69: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:32:23][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:32:24][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:32:24][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:32:24][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:32:24][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:32:24][INFO] train_net.py: 649: Start epoch: 1
[06/06 20:34:17][INFO] train_net.py: 601: Train with config:
[06/06 20:34:17][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/06 20:34:25][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/06 20:34:26][INFO] cholec80.py:  69: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/06 20:34:26][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/06 20:34:26][INFO] cholec80.py:  69: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/06 20:34:27][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/06 20:34:27][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/06 20:34:27][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/06 20:34:27][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/06 20:34:28][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/06 20:34:28][INFO] train_net.py: 649: Start epoch: 1
[06/07 15:26:18][INFO] train_net.py: 601: Train with config:
[06/07 15:26:18][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:26:27][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:26:28][INFO] cholec80.py:  71: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 15:26:28][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 15:26:29][INFO] cholec80.py:  71: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 15:26:31][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 15:26:42][INFO] train_net.py: 601: Train with config:
[06/07 15:26:42][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:26:50][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:42:39][INFO] train_net.py: 601: Train with config:
[06/07 15:42:39][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:42:47][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:45:49][INFO] train_net.py: 601: Train with config:
[06/07 15:45:49][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:45:58][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:46:00][INFO] cholec80.py:  85: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 15:46:00][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 15:46:01][INFO] cholec80.py:  85: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 15:46:01][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 15:46:02][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 15:46:02][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 15:46:03][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 15:46:04][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 15:46:04][INFO] train_net.py: 649: Start epoch: 1
[06/07 15:46:19][INFO] train_net.py: 601: Train with config:
[06/07 15:46:19][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:46:27][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:51:38][INFO] train_net.py: 601: Train with config:
[06/07 15:51:38][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:51:46][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:56:04][INFO] train_net.py: 601: Train with config:
[06/07 15:56:04][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:56:13][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:56:42][INFO] train_net.py: 601: Train with config:
[06/07 15:56:42][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:56:50][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:57:02][INFO] train_net.py: 601: Train with config:
[06/07 15:57:02][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:57:10][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:57:58][INFO] train_net.py: 601: Train with config:
[06/07 15:57:58][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:58:06][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:58:45][INFO] train_net.py: 601: Train with config:
[06/07 15:58:45][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:58:53][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:58:53][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 15:58:53][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 15:58:54][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 15:58:55][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 15:58:55][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 15:58:55][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 15:58:55][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 15:58:56][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 15:58:56][INFO] train_net.py: 649: Start epoch: 1
[06/07 15:59:50][INFO] train_net.py: 601: Train with config:
[06/07 15:59:50][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 15:59:58][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 15:59:59][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 15:59:59][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 15:59:59][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:00:00][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:00:00][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:00:00][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:00:00][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:00:01][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:00:01][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:13:08][INFO] train_net.py: 601: Train with config:
[06/07 16:13:08][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:13:16][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:13:17][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:13:17][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:13:17][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:13:18][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:13:19][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:13:19][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:13:19][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:13:19][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:13:19][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:13:33][INFO] train_net.py: 601: Train with config:
[06/07 16:13:33][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:13:42][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:13:42][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:13:42][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:13:42][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:13:43][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:13:44][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:13:44][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:13:44][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:13:45][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:13:45][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:14:05][INFO] train_net.py: 601: Train with config:
[06/07 16:14:05][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:14:13][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:14:14][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:14:14][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:14:14][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:14:15][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:14:16][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:14:16][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:14:16][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:14:16][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:14:16][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:14:49][INFO] train_net.py: 601: Train with config:
[06/07 16:14:49][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:14:58][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:14:58][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:14:58][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:14:59][INFO] cholec80.py:  86: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:15:00][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:15:00][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:15:00][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:15:00][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:15:01][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:15:01][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:16:11][INFO] train_net.py: 601: Train with config:
[06/07 16:16:11][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:16:19][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:21:53][INFO] train_net.py: 601: Train with config:
[06/07 16:21:53][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:22:02][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:22:03][INFO] cholec80.py:  88: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:22:03][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:22:03][INFO] cholec80.py:  88: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:22:04][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:22:04][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:22:04][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:22:04][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:22:05][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:22:05][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:25:07][INFO] train_net.py: 601: Train with config:
[06/07 16:25:07][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:25:15][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:25:16][INFO] cholec80.py:  88: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:25:16][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:25:16][INFO] cholec80.py:  88: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:25:17][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:25:17][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:25:17][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:25:18][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:25:18][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:25:18][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:26:52][INFO] train_net.py: 601: Train with config:
[06/07 16:26:52][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:27:00][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:27:01][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:27:01][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:27:01][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:27:02][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:27:02][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:27:02][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:27:02][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:27:03][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:27:03][INFO] train_net.py: 649: Start epoch: 1
[06/07 16:28:11][INFO] train_net.py: 601: Train with config:
[06/07 16:28:11][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 16:28:20][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 16:28:21][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 16:28:21][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 16:28:21][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 16:28:22][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 16:28:22][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 16:28:22][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 16:28:22][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 16:28:23][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 16:28:23][INFO] train_net.py: 649: Start epoch: 1
[06/07 17:09:09][INFO] train_net.py: 601: Train with config:
[06/07 17:09:09][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 17:09:17][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 17:09:18][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 17:09:18][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 17:09:18][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 17:09:19][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 17:09:20][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 17:09:20][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 17:09:20][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 17:09:20][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 17:09:20][INFO] train_net.py: 649: Start epoch: 1
[06/07 17:09:42][INFO] train_net.py: 601: Train with config:
[06/07 17:09:42][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 17:09:51][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 17:09:51][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 17:09:51][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 17:09:51][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 17:09:52][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 17:09:53][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 17:09:53][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 17:09:53][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 17:09:53][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 17:09:53][INFO] train_net.py: 649: Start epoch: 1
[06/07 17:58:37][INFO] train_net.py: 601: Train with config:
[06/07 17:58:37][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 17:58:46][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 17:58:46][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 17:58:46][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 17:58:46][INFO] cholec80.py:  90: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 17:58:47][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 17:58:48][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 17:58:48][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 17:58:48][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 17:58:48][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 17:58:48][INFO] train_net.py: 649: Start epoch: 1
[06/07 18:00:33][INFO] train_net.py: 601: Train with config:
[06/07 18:00:33][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 18:00:42][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 18:00:43][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 18:00:43][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 18:00:43][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 18:00:44][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 18:00:44][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 18:00:44][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 18:00:44][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 18:00:45][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 18:00:45][INFO] train_net.py: 649: Start epoch: 1
[06/07 18:12:56][INFO] train_net.py: 601: Train with config:
[06/07 18:12:56][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 18:13:06][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 18:13:06][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 18:13:06][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 18:13:06][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 18:13:07][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 18:13:08][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 18:13:08][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 18:13:08][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 18:13:09][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 18:13:09][INFO] train_net.py: 649: Start epoch: 1
[06/07 18:23:16][INFO] train_net.py: 601: Train with config:
[06/07 18:23:16][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 18:23:25][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 18:23:25][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 18:23:25][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 18:23:25][INFO] cholec80.py:  92: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 18:23:26][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 18:23:27][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 18:23:27][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 18:23:27][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 18:23:27][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 18:23:27][INFO] train_net.py: 649: Start epoch: 1
[06/07 18:26:20][INFO] train_net.py: 601: Train with config:
[06/07 18:26:20][INFO] train_net.py: 602: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 18:26:28][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 18:26:29][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 18:26:29][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 18:26:29][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 18:26:30][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 18:26:30][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 18:26:30][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 18:26:31][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 18:26:31][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 18:26:31][INFO] train_net.py: 649: Start epoch: 1
[06/07 18:26:47][INFO] optimizer.py: 175: Set lr 5e-05 for all paramters groups
[06/07 19:38:32][INFO] slot_train_net.py:  55: Train with config:
[06/07 19:38:32][INFO] slot_train_net.py:  56: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 19:38:40][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 19:38:41][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 19:38:41][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 19:38:41][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 19:40:12][INFO] slot_train_net.py:  55: Train with config:
[06/07 19:40:12][INFO] slot_train_net.py:  56: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/07 19:40:21][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/07 19:40:21][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/07 19:40:21][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/07 19:40:21][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/07 19:40:22][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/07 19:40:23][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/07 19:40:23][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/07 19:40:23][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/07 19:40:24][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/07 19:40:24][INFO] slot_train_net.py:  95: Start epoch: 1
[06/08 10:39:50][INFO] slot_train_net.py: 183: Train with config:
[06/08 10:39:50][INFO] slot_train_net.py: 184: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:39:59][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:39:59][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 86344) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:39:59][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:40:00][INFO] cholec80.py:  91: Cholec80 dataloader constructed (size: 21445) from datasets/cholec80/labels/val/1fps.pickle
[06/08 10:40:01][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 10:40:01][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 10:40:01][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 10:40:01][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 10:40:02][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 10:40:02][INFO] slot_train_net.py: 223: Start epoch: 1
[06/08 10:42:14][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:42:14][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:42:23][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:42:24][INFO] cholec80.py:  95: Cholec80 dataloader constructed (size: 1734) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:42:24][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:43:42][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:43:42][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:43:50][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:44:26][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:44:26][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:44:35][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:44:35][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 2840) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:44:35][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:45:56][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:45:56][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:46:04][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:46:31][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:46:31][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:46:39][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:46:40][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:46:40][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:46:40][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 10:46:41][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 10:46:41][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 10:46:41][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 10:46:41][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 10:46:42][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 10:46:42][INFO] slot_train_net.py: 224: Start epoch: 1
[06/08 10:54:47][INFO] slot_train_net.py: 184: Train with config:
[06/08 10:54:47][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:54:57][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:54:57][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:54:57][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:54:58][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 10:54:58][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 10:54:59][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 10:54:59][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 10:54:59][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 10:55:00][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 10:55:00][INFO] slot_train_net.py: 225: Start epoch: 1
[06/08 10:58:29][INFO] slot_train_net.py: 188: Train with config:
[06/08 10:58:29][INFO] slot_train_net.py: 189: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adamw',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 10:58:38][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 10:58:39][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 10:58:39][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 10:58:39][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 10:58:40][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 10:58:40][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 10:58:40][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 10:58:40][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 10:58:41][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 10:58:41][INFO] slot_train_net.py: 229: Start epoch: 1
[06/08 11:00:51][INFO] slot_train_net.py: 184: Train with config:
[06/08 11:00:51][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:01:00][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:01:01][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:01:01][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:01:01][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:01:02][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:01:03][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:01:03][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:01:03][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:01:03][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:01:03][INFO] slot_train_net.py: 225: Start epoch: 1
[06/08 11:10:35][INFO] slot_train_net.py: 184: Train with config:
[06/08 11:10:35][INFO] slot_train_net.py: 185: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:10:45][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:10:45][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:10:45][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:10:45][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:10:46][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:10:47][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:10:47][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:10:47][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:10:47][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:10:47][INFO] slot_train_net.py: 225: Start epoch: 1
[06/08 11:13:35][INFO] slot_train_net.py: 188: Train with config:
[06/08 11:13:35][INFO] slot_train_net.py: 189: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:13:44][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:13:45][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:13:45][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:13:45][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:13:46][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:13:46][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:13:46][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:13:46][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:13:47][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:13:47][INFO] slot_train_net.py: 229: Start epoch: 1
[06/08 11:16:13][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:16:13][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:16:22][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:16:22][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:16:22][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:16:23][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:16:24][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:16:24][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:16:24][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:16:24][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:16:25][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:16:25][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:16:57][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:16:57][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:17:06][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:17:06][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:17:06][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:17:06][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:17:07][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:17:08][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:17:08][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:17:08][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:17:08][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:17:08][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:19:06][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:19:06][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:19:15][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:19:15][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:19:15][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:19:16][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:19:16][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:19:17][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:19:17][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:19:17][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:19:18][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:19:18][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:19:36][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:19:36][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 224,
          'TRAIN_CROP_SIZE': 224,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:19:45][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:19:46][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:19:46][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:19:46][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:19:47][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:19:48][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:19:48][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:19:48][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:19:48][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:19:48][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:21:17][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:21:17][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:21:26][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:21:26][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:21:26][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:21:26][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:21:27][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:21:28][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:21:28][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:21:28][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:21:28][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:21:28][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:23:03][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:23:03][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:23:11][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:23:11][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:23:11][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:23:12][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:23:12][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:23:13][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:23:13][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:23:13][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:23:14][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:23:14][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:24:30][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:24:30][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:24:39][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:24:39][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:24:39][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:24:39][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:24:40][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:24:41][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:24:41][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:24:41][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:24:41][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:24:41][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:25:26][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:25:26][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:25:34][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:25:35][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:25:35][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:25:35][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:25:36][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:25:37][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:25:37][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:25:37][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:25:37][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:25:37][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:33:18][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:33:18][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 16,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 7,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:33:27][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:33:27][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:33:27][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:33:28][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:33:29][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:33:29][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:33:29][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:33:29][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:33:30][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:33:30][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:34:21][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:34:21][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:34:30][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:34:30][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:34:30][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:34:30][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:34:31][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:34:32][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:34:32][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:34:32][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:34:33][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:34:33][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 11:34:55][INFO] slot_train_net.py: 187: Train with config:
[06/08 11:34:55][INFO] slot_train_net.py: 188: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 11:35:05][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 11:35:05][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 11:35:05][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 11:35:05][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 11:35:06][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 11:35:07][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 11:35:07][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 11:35:07][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 11:35:08][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 11:35:08][INFO] slot_train_net.py: 228: Start epoch: 1
[06/08 17:00:23][INFO] slot_train_net.py: 198: Train with config:
[06/08 17:00:23][INFO] slot_train_net.py: 199: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:00:33][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:00:33][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:00:33][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:00:34][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:00:35][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:00:35][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:00:35][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:00:35][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:00:36][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:00:36][INFO] slot_train_net.py: 239: Start epoch: 1
[06/08 17:01:22][INFO] slot_train_net.py: 198: Train with config:
[06/08 17:01:22][INFO] slot_train_net.py: 199: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:01:30][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:01:31][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:01:31][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:01:31][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:01:32][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:01:33][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:01:33][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:01:33][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:01:33][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:01:33][INFO] slot_train_net.py: 239: Start epoch: 1
[06/08 17:02:02][INFO] slot_train_net.py: 198: Train with config:
[06/08 17:02:02][INFO] slot_train_net.py: 199: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:02:11][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:02:11][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:02:11][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:02:11][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:02:12][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:02:13][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:02:13][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:02:13][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:02:13][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:02:13][INFO] slot_train_net.py: 239: Start epoch: 1
[06/08 17:04:56][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:04:56][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:05:06][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:05:07][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:05:07][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:05:07][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:05:08][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:05:08][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:05:08][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:05:08][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:05:09][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:05:09][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:05:43][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:05:43][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:05:51][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:05:51][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3946) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:05:51][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:05:52][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 3713) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:05:53][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:05:53][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:05:53][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:05:53][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:05:54][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:05:54][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:07:25][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:07:25][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:07:33][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:07:34][INFO] cholec80.py:  98: Cholec80 dataloader constructed (size: 2840) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:07:34][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:08:00][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:08:00][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:08:09][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:08:46][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:08:46][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:08:55][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:09:26][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:09:26][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:09:35][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:09:47][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:09:47][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:09:56][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:09:56][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 2388) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:09:56][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:09:57][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 1835) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:09:57][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:09:58][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:09:58][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:09:58][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:09:59][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:09:59][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:10:36][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:10:36][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 32,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:10:46][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:10:47][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 2388) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:10:47][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:10:47][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 1835) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:10:48][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:10:48][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:10:48][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:10:48][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:10:49][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:10:49][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:11:15][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:11:15][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 8,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:11:23][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:11:24][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 2388) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:11:24][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:11:24][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 1835) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:11:25][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:11:25][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:11:25][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:11:25][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:11:26][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:11:26][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:12:01][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:12:01][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:12:10][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:12:10][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 2388) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:12:10][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:12:10][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 1835) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:12:11][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:12:12][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:12:12][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:12:12][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:12:13][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:12:13][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:12:50][INFO] slot_train_net.py: 202: Train with config:
[06/08 17:12:50][INFO] slot_train_net.py: 203: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:12:59][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:12:59][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:12:59][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:13:00][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:13:00][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:13:01][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:13:01][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:13:01][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:13:02][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:13:02][INFO] slot_train_net.py: 243: Start epoch: 1
[06/08 17:19:51][INFO] slot_train_net.py: 204: Train with config:
[06/08 17:19:51][INFO] slot_train_net.py: 205: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:20:00][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:20:00][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:20:00][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:20:01][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:20:02][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:20:02][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:20:02][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:20:02][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:20:03][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:20:03][INFO] slot_train_net.py: 245: Start epoch: 1
[06/08 17:23:31][INFO] slot_train_net.py: 205: Train with config:
[06/08 17:23:31][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:23:40][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:23:41][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:23:41][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:23:41][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:23:42][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:23:43][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:23:43][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:23:43][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:23:43][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:23:43][INFO] slot_train_net.py: 246: Start epoch: 1
[06/08 17:24:58][INFO] slot_train_net.py: 205: Train with config:
[06/08 17:24:58][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:25:08][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:25:08][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:25:08][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:25:08][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:25:09][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:25:10][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:25:10][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:25:10][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:25:16][INFO] slot_train_net.py: 205: Train with config:
[06/08 17:25:16][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:25:25][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:25:25][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:25:25][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:25:26][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:25:26][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:25:27][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:25:27][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:25:27][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:25:28][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:25:28][INFO] slot_train_net.py: 246: Start epoch: 1
[06/08 17:26:37][INFO] slot_train_net.py: 205: Train with config:
[06/08 17:26:37][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/08 17:26:46][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/08 17:26:47][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/08 17:26:47][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/08 17:26:47][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/08 17:26:48][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/08 17:26:48][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/08 17:26:48][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/08 17:26:48][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/08 17:26:49][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/08 17:26:49][INFO] slot_train_net.py: 246: Start epoch: 1
[06/15 14:37:43][INFO] slot_train_net.py: 205: Train with config:
[06/15 14:37:43][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/15 14:37:52][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/15 14:37:53][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/15 14:37:53][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/15 14:37:53][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/15 14:37:59][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/15 14:38:02][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/15 14:38:02][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/15 14:38:03][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/15 14:38:09][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/15 14:38:09][INFO] slot_train_net.py: 246: Start epoch: 1
[06/15 14:39:13][INFO] slot_train_net.py: 292: Epoch 0 takes 64.60s. Epochs from 0 to 0 take 64.60s in average and 64.60s in median.
[06/15 14:39:13][INFO] slot_train_net.py: 298: For epoch 0, each iteraction takes 5.38s in average. From epoch 0 to 0, each iteraction takes 5.38s in average.
[06/15 14:40:48][INFO] slot_train_net.py: 292: Epoch 1 takes 44.44s. Epochs from 0 to 1 take 54.52s in average and 54.52s in median.
[06/15 14:40:48][INFO] slot_train_net.py: 298: For epoch 1, each iteraction takes 3.70s in average. From epoch 0 to 1, each iteraction takes 4.54s in average.
[06/15 14:42:15][INFO] slot_train_net.py: 292: Epoch 2 takes 44.38s. Epochs from 0 to 2 take 51.14s in average and 44.44s in median.
[06/15 14:42:15][INFO] slot_train_net.py: 298: For epoch 2, each iteraction takes 3.70s in average. From epoch 0 to 2, each iteraction takes 4.26s in average.
[06/15 14:43:41][INFO] slot_train_net.py: 292: Epoch 3 takes 44.15s. Epochs from 0 to 3 take 49.40s in average and 44.41s in median.
[06/15 14:43:41][INFO] slot_train_net.py: 298: For epoch 3, each iteraction takes 3.68s in average. From epoch 0 to 3, each iteraction takes 4.12s in average.
[06/15 14:45:15][INFO] slot_train_net.py: 292: Epoch 4 takes 44.18s. Epochs from 0 to 4 take 48.35s in average and 44.38s in median.
[06/15 14:45:15][INFO] slot_train_net.py: 298: For epoch 4, each iteraction takes 3.68s in average. From epoch 0 to 4, each iteraction takes 4.03s in average.
[06/16 13:53:43][INFO] slot_train_net.py: 205: Train with config:
[06/16 13:53:43][INFO] slot_train_net.py: 206: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 13:53:54][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 13:53:54][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 13:53:54][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 13:53:55][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 13:54:01][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 13:54:04][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 13:54:04][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 13:54:05][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 13:54:10][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 13:54:10][INFO] slot_train_net.py: 246: Start epoch: 1
[06/16 13:55:06][INFO] slot_train_net.py: 292: Epoch 0 takes 55.58s. Epochs from 0 to 0 take 55.58s in average and 55.58s in median.
[06/16 13:55:06][INFO] slot_train_net.py: 298: For epoch 0, each iteraction takes 4.63s in average. From epoch 0 to 0, each iteraction takes 4.63s in average.
[06/16 13:59:27][INFO] slot_train_net.py: 210: Train with config:
[06/16 13:59:27][INFO] slot_train_net.py: 211: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 13:59:37][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 13:59:37][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 13:59:37][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 13:59:38][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 13:59:38][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 13:59:39][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 13:59:39][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 13:59:39][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 13:59:40][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 13:59:40][INFO] slot_train_net.py: 251: Start epoch: 1
[06/16 14:00:27][INFO] slot_train_net.py: 297: Epoch 0 takes 47.15s. Epochs from 0 to 0 take 47.15s in average and 47.15s in median.
[06/16 14:00:27][INFO] slot_train_net.py: 303: For epoch 0, each iteraction takes 3.93s in average. From epoch 0 to 0, each iteraction takes 3.93s in average.
[06/16 14:03:08][INFO] slot_train_net.py: 297: Epoch 1 takes 43.50s. Epochs from 0 to 1 take 45.33s in average and 45.33s in median.
[06/16 14:03:08][INFO] slot_train_net.py: 303: For epoch 1, each iteraction takes 3.62s in average. From epoch 0 to 1, each iteraction takes 3.78s in average.
[06/16 14:04:47][INFO] slot_train_net.py: 297: Epoch 2 takes 43.81s. Epochs from 0 to 2 take 44.82s in average and 43.81s in median.
[06/16 14:04:47][INFO] slot_train_net.py: 303: For epoch 2, each iteraction takes 3.65s in average. From epoch 0 to 2, each iteraction takes 3.74s in average.
[06/16 14:06:28][INFO] slot_train_net.py: 297: Epoch 3 takes 43.98s. Epochs from 0 to 3 take 44.61s in average and 43.90s in median.
[06/16 14:06:28][INFO] slot_train_net.py: 303: For epoch 3, each iteraction takes 3.67s in average. From epoch 0 to 3, each iteraction takes 3.72s in average.
[06/16 14:08:17][INFO] slot_train_net.py: 297: Epoch 4 takes 43.84s. Epochs from 0 to 4 take 44.46s in average and 43.84s in median.
[06/16 14:08:17][INFO] slot_train_net.py: 303: For epoch 4, each iteraction takes 3.65s in average. From epoch 0 to 4, each iteraction takes 3.70s in average.
[06/16 14:15:46][INFO] slot_train_net.py: 253: Train with config:
[06/16 14:15:46][INFO] slot_train_net.py: 254: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 14:15:57][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 14:15:59][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 14:15:59][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 14:15:59][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 14:16:03][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 14:16:05][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 14:16:05][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 14:16:06][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 14:16:07][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 14:16:07][INFO] slot_train_net.py: 294: Start epoch: 1
[06/16 14:17:08][INFO] slot_train_net.py: 340: Epoch 0 takes 61.07s. Epochs from 0 to 0 take 61.07s in average and 61.07s in median.
[06/16 14:17:08][INFO] slot_train_net.py: 346: For epoch 0, each iteraction takes 5.09s in average. From epoch 0 to 0, each iteraction takes 5.09s in average.
[06/16 14:19:25][INFO] slot_train_net.py: 340: Epoch 1 takes 47.52s. Epochs from 0 to 1 take 54.29s in average and 54.29s in median.
[06/16 14:19:25][INFO] slot_train_net.py: 346: For epoch 1, each iteraction takes 3.96s in average. From epoch 0 to 1, each iteraction takes 4.52s in average.
[06/16 14:21:13][INFO] slot_train_net.py: 340: Epoch 2 takes 44.32s. Epochs from 0 to 2 take 50.97s in average and 47.52s in median.
[06/16 14:21:13][INFO] slot_train_net.py: 346: For epoch 2, each iteraction takes 3.69s in average. From epoch 0 to 2, each iteraction takes 4.25s in average.
[06/16 14:23:58][INFO] slot_train_net.py: 340: Epoch 3 takes 45.04s. Epochs from 0 to 3 take 49.49s in average and 46.28s in median.
[06/16 14:23:58][INFO] slot_train_net.py: 346: For epoch 3, each iteraction takes 3.75s in average. From epoch 0 to 3, each iteraction takes 4.12s in average.
[06/16 14:26:06][INFO] slot_train_net.py: 340: Epoch 4 takes 44.46s. Epochs from 0 to 4 take 48.48s in average and 45.04s in median.
[06/16 14:26:06][INFO] slot_train_net.py: 346: For epoch 4, each iteraction takes 3.71s in average. From epoch 0 to 4, each iteraction takes 4.04s in average.
[06/16 14:29:59][INFO] slot_train_net.py: 340: Epoch 5 takes 47.18s. Epochs from 0 to 5 take 48.27s in average and 46.11s in median.
[06/16 14:29:59][INFO] slot_train_net.py: 346: For epoch 5, each iteraction takes 3.93s in average. From epoch 0 to 5, each iteraction takes 4.02s in average.
[06/16 14:31:27][INFO] slot_train_net.py: 340: Epoch 6 takes 44.04s. Epochs from 0 to 6 take 47.66s in average and 45.04s in median.
[06/16 14:31:27][INFO] slot_train_net.py: 346: For epoch 6, each iteraction takes 3.67s in average. From epoch 0 to 6, each iteraction takes 3.97s in average.
[06/16 14:33:18][INFO] slot_train_net.py: 340: Epoch 7 takes 44.24s. Epochs from 0 to 7 take 47.23s in average and 44.75s in median.
[06/16 14:33:18][INFO] slot_train_net.py: 346: For epoch 7, each iteraction takes 3.69s in average. From epoch 0 to 7, each iteraction takes 3.94s in average.
[06/16 14:34:33][INFO] slot_train_net.py: 340: Epoch 8 takes 44.31s. Epochs from 0 to 8 take 46.91s in average and 44.46s in median.
[06/16 14:34:33][INFO] slot_train_net.py: 346: For epoch 8, each iteraction takes 3.69s in average. From epoch 0 to 8, each iteraction takes 3.91s in average.
[06/16 14:36:10][INFO] slot_train_net.py: 340: Epoch 9 takes 44.21s. Epochs from 0 to 9 take 46.64s in average and 44.39s in median.
[06/16 14:36:10][INFO] slot_train_net.py: 346: For epoch 9, each iteraction takes 3.68s in average. From epoch 0 to 9, each iteraction takes 3.89s in average.
[06/16 15:11:14][INFO] slot_train_net.py: 243: Train with config:
[06/16 15:11:14][INFO] slot_train_net.py: 244: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 15:11:31][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 15:11:32][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 15:11:32][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 15:11:32][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 15:11:38][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 15:11:39][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 15:11:39][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 15:11:40][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 15:11:45][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 15:11:45][INFO] slot_train_net.py: 285: Start epoch: 1
[06/16 15:12:54][INFO] slot_train_net.py: 334: Epoch 0 takes 68.22s. Epochs from 0 to 0 take 68.22s in average and 68.22s in median.
[06/16 15:12:54][INFO] slot_train_net.py: 340: For epoch 0, each iteraction takes 5.68s in average. From epoch 0 to 0, each iteraction takes 5.68s in average.
[06/16 15:35:26][INFO] slot_train_net.py: 248: Train with config:
[06/16 15:35:26][INFO] slot_train_net.py: 249: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 15:35:34][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 15:35:34][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 15:35:34][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 15:35:35][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 15:35:35][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 15:35:36][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 15:35:36][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 15:35:36][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 15:35:37][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 15:35:37][INFO] slot_train_net.py: 290: Start epoch: 1
[06/16 15:36:24][INFO] slot_train_net.py: 339: Epoch 0 takes 46.90s. Epochs from 0 to 0 take 46.90s in average and 46.90s in median.
[06/16 15:36:24][INFO] slot_train_net.py: 345: For epoch 0, each iteraction takes 3.91s in average. From epoch 0 to 0, each iteraction takes 3.91s in average.
[06/16 15:39:13][INFO] slot_train_net.py: 248: Train with config:
[06/16 15:39:13][INFO] slot_train_net.py: 249: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 15:39:21][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 15:39:22][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 15:39:22][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 15:39:22][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 15:39:23][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 15:39:24][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 15:39:24][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 15:39:24][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 15:39:24][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 15:39:24][INFO] slot_train_net.py: 290: Start epoch: 1
[06/16 15:40:11][INFO] slot_train_net.py: 339: Epoch 0 takes 46.45s. Epochs from 0 to 0 take 46.45s in average and 46.45s in median.
[06/16 15:40:11][INFO] slot_train_net.py: 345: For epoch 0, each iteraction takes 3.87s in average. From epoch 0 to 0, each iteraction takes 3.87s in average.
[06/16 15:41:09][INFO] slot_train_net.py: 248: Train with config:
[06/16 15:41:09][INFO] slot_train_net.py: 249: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 15:41:17][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 15:41:18][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 15:41:18][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 15:41:18][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 15:41:19][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 15:41:19][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 15:41:19][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 15:41:19][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 15:41:20][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 15:41:20][INFO] slot_train_net.py: 290: Start epoch: 1
[06/16 15:42:07][INFO] slot_train_net.py: 339: Epoch 0 takes 46.71s. Epochs from 0 to 0 take 46.71s in average and 46.71s in median.
[06/16 15:42:07][INFO] slot_train_net.py: 345: For epoch 0, each iteraction takes 3.89s in average. From epoch 0 to 0, each iteraction takes 3.89s in average.
[06/16 15:44:02][INFO] slot_train_net.py: 339: Epoch 1 takes 43.60s. Epochs from 0 to 1 take 45.16s in average and 45.16s in median.
[06/16 15:44:02][INFO] slot_train_net.py: 345: For epoch 1, each iteraction takes 3.63s in average. From epoch 0 to 1, each iteraction takes 3.76s in average.
[06/16 15:45:45][INFO] slot_train_net.py: 339: Epoch 2 takes 43.76s. Epochs from 0 to 2 take 44.69s in average and 43.76s in median.
[06/16 15:45:45][INFO] slot_train_net.py: 345: For epoch 2, each iteraction takes 3.65s in average. From epoch 0 to 2, each iteraction takes 3.72s in average.
[06/16 15:49:49][INFO] slot_train_net.py: 248: Train with config:
[06/16 15:49:49][INFO] slot_train_net.py: 249: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 15:49:58][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 15:49:59][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 15:49:59][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 15:49:59][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 15:50:02][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 15:50:03][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 15:50:03][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 15:50:03][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 15:50:04][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 15:50:04][INFO] slot_train_net.py: 290: Start epoch: 1
[06/16 16:10:01][INFO] slot_train_net.py: 248: Train with config:
[06/16 16:10:01][INFO] slot_train_net.py: 249: {'AUG': {'AA_TYPE': 'rand-m7-n4-mstd0.5-inc1',
         'COLOR_JITTER': 0.0,
         'DIFFERENT_AUG_PER_FRAME': True,
         'ENABLE': True,
         'INTERPOLATION': 'bicubic',
         'NUM_SAMPLE': 1,
         'RE_COUNT': 1,
         'RE_MODE': 'pixel',
         'RE_PROB': 0.0,
         'RE_SPLIT': False},
 'AVA': {'ANNOTATION_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/annotations',
         'BGR': False,
         'CENTER_CROP_TEST': True,
         'DETECTION_SCORE_THRESH': 0.9,
         'EXCLUSION_FILE': 'ava_val_excluded_timestamps_v2.2.csv',
         'FRAME_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frames',
         'FRAME_LIST_DIR': '/home/gamir/DER-Roei/datasets/AVA/download_repo/data/ava/frame_lists',
         'FULL_TEST_ON_VAL': False,
         'GROUNDTRUTH_FILE': 'ava_val_v2.2.csv',
         'IMG_PROC_BACKEND': 'cv2',
         'LABEL_MAP_FILE': 'ava_action_list_v2.2_for_activitynet_2019.pbtxt',
         'TEST_FORCE_FLIP': False,
         'TEST_LISTS': ['val.csv'],
         'TEST_PREDICT_BOX_LISTS': ['ava_val_predicted_boxes.csv'],
         'TRAIN_GT_BOX_LISTS': ['ava_train_v2.2.csv'],
         'TRAIN_LISTS': ['train.csv'],
         'TRAIN_PCA_JITTER_ONLY': True,
         'TRAIN_PREDICT_BOX_LISTS': [],
         'TRAIN_USE_COLOR_AUGMENTATION': False},
 'BENCHMARK': CfgNode({'NUM_EPOCHS': 5, 'LOG_PERIOD': 100, 'SHUFFLE': True}),
 'BN': {'NORM_TYPE': 'batchnorm',
        'NUM_BATCHES_PRECISE': 200,
        'NUM_SPLITS': 1,
        'NUM_SYNC_DEVICES': 1,
        'USE_PRECISE_STATS': False,
        'WEIGHT_DECAY': 0.0},
 'CHOLEC': {'PATH': 'datasets/cholec80/labels',
            'TEST_PKL': '1fps.pickle',
            'TRAIN_PKL': '1fps_100_0.pickle',
            'VAL_PKL': '1fps.pickle'},
 'CUDA_VISIBLE_DEVICES': '0',
 'DATA': {'DECODING_BACKEND': 'torchvision',
          'ENSEMBLE_METHOD': 'sum',
          'FEAT_H': 8,
          'FEAT_W': 14,
          'FOLD': 1,
          'INPUT_CHANNEL_NUM': [3],
          'INV_UNIFORM_SAMPLE': True,
          'MEAN': [0.5, 0.5, 0.5],
          'MULTI_LABEL': False,
          'NUM_FRAMES': 4,
          'PATH': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_LABEL_SEPARATOR': ' ',
          'PATH_PREFIX': '/home/ssharma/datasets/surgical/cholec/cholec80/frames',
          'PATH_TO_DATA_DIR': '/home/ssharma/datasets/surgical/cholec/cholec80',
          'PATH_TO_PRELOAD_IMDB': '',
          'RANDOM_FLIP': False,
          'REVERSE_INPUT_CHANNEL': True,
          'SAMPLING_RATE': 1,
          'SCALE': [448, 256, 448, 256],
          'SPLIT': 'ctp',
          'STD': [0.5, 0.5, 0.5],
          'TARGET_FPS': 30,
          'TEST_CROP_SIZE': 64,
          'TRAIN_CROP_SIZE': 64,
          'TRAIN_JITTER_ASPECT_RELATIVE': [0.75, 1.3333],
          'TRAIN_JITTER_MOTION_SHIFT': False,
          'TRAIN_JITTER_SCALES': [256, 320],
          'TRAIN_JITTER_SCALES_RELATIVE': [0.08, 1.0],
          'TRAIN_PCA_EIGVAL': [0.225, 0.224, 0.229],
          'TRAIN_PCA_EIGVEC': [[-0.5675, 0.7192, 0.4009],
                               [-0.5808, -0.0045, -0.814],
                               [-0.5836, -0.6948, 0.4203]],
          'USE_OFFSET_SAMPLING': True},
 'DATA_LOADER': {'ENABLE_MULTI_THREAD_DECODE': False,
                 'NUM_WORKERS': 6,
                 'PIN_MEMORY': True},
 'DEMO': {'BUFFER_SIZE': 0,
          'CLIP_VIS_SIZE': 10,
          'COMMON_CLASS_NAMES': ['watch (a person)',
                                 'talk to (e.g., self, a person, a group)',
                                 'listen to (a person)',
                                 'touch (an object)',
                                 'carry/hold (an object)',
                                 'walk',
                                 'sit',
                                 'lie/sleep',
                                 'bend/bow (at the waist)'],
          'COMMON_CLASS_THRES': 0.7,
          'DETECTRON2_CFG': 'COCO-Detection/faster_rcnn_R_50_FPN_3x.yaml',
          'DETECTRON2_THRESH': 0.9,
          'DETECTRON2_WEIGHTS': 'detectron2://COCO-Detection/faster_rcnn_R_50_FPN_3x/137849458/model_final_280758.pkl',
          'DISPLAY_HEIGHT': 0,
          'DISPLAY_WIDTH': 0,
          'ENABLE': False,
          'FPS': 30,
          'GT_BOXES': '',
          'INPUT_FORMAT': 'BGR',
          'INPUT_VIDEO': '',
          'LABEL_FILE_PATH': '',
          'NUM_CLIPS_SKIP': 0,
          'NUM_VIS_INSTANCES': 2,
          'OUTPUT_FILE': '',
          'OUTPUT_FPS': -1,
          'PREDS_BOXES': '',
          'SLOWMO': 1,
          'STARTING_SECOND': 900,
          'THREAD_ENABLE': False,
          'UNCOMMON_CLASS_THRES': 0.3,
          'VIS_MODE': 'thres',
          'WEBCAM': -1},
 'DETECTION': {'ALIGNED': True,
               'ENABLE': False,
               'ROI_XFORM_RESOLUTION': 7,
               'SPATIAL_SCALE_FACTOR': 16},
 'DIST_BACKEND': 'nccl',
 'EPICKITCHENS': {'ANNOTATIONS_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS',
                  'TEST_LIST': 'EPIC_100_validation.pkl',
                  'TEST_SPLIT': 'validation',
                  'TRAIN_LIST': 'EPIC_100_train.pkl',
                  'TRAIN_PLUS_VAL': False,
                  'VAL_LIST': 'EPIC_100_validation.pkl',
                  'VISUAL_DATA_DIR': '/home/gamir/datasets/datasets/EPIC-KITCHENS/epic-kitchens-download-scripts-master/EPIC-KITCHENS'},
 'LOG_MODEL_INFO': False,
 'LOG_PERIOD': 10,
 'MF': {'APPROX_ATTN_DIM': 128,
        'APPROX_ATTN_TYPE': 'none',
        'ATTN_DROPOUT': 0.0,
        'ATTN_LAYER': 'trajectory',
        'CHANNELS': 3,
        'DEPTH': 12,
        'DROP': 0.0,
        'DROP_PATH': 0.2,
        'EMBED_DIM': 768,
        'HEAD_ACT': 'tanh',
        'HEAD_DROPOUT': 0.0,
        'IM_PRETRAINED': True,
        'MLP_RATIO': 4,
        'NUM_HEADS': 12,
        'PATCH_SIZE': 16,
        'PATCH_SIZE_TEMP': 2,
        'POS_DROPOUT': 0.0,
        'POS_EMBED': 'separate',
        'PRETRAINED_WEIGHTS': 'vit_1k',
        'QKV_BIAS': True,
        'TEMPORAL_RESOLUTION': 8,
        'USE_MLP': True,
        'VIDEO_INPUT': True},
 'MIXUP': {'ALPHA': 0.8,
           'CUTMIX_ALPHA': 1.0,
           'ENABLE': False,
           'LABEL_SMOOTH_VALUE': 0.1,
           'PROB': 1.0,
           'SWITCH_PROB': 0.5},
 'MODEL': {'ARCH': 'slow',
           'DROPCONNECT_RATE': 0.0,
           'DROPOUT_RATE': 0.5,
           'FC_INIT_STD': 0.01,
           'HEAD_ACT': 'softmax',
           'LOAD_IN_PRETRAIN': '',
           'LOSS_FUNC': 'label_smoothing_cross_entropy',
           'MODEL_NAME': 'STEVE',
           'MULTI_PATHWAY_ARCH': ['slowfast'],
           'NUM_CLASSES': 174,
           'SINGLE_PATHWAY_ARCH': ['2d', 'c2d', 'i3d', 'slow', 'x3d', 'mvit']},
 'MULTIGRID': {'BN_BASE_SIZE': 8,
               'DEFAULT_B': 0,
               'DEFAULT_S': 0,
               'DEFAULT_T': 0,
               'EPOCH_FACTOR': 1.5,
               'EVAL_FREQ': 3,
               'LONG_CYCLE': False,
               'LONG_CYCLE_FACTORS': [(0.25, 0.7071067811865476),
                                      (0.5, 0.7071067811865476),
                                      (0.5, 1),
                                      (1, 1)],
               'LONG_CYCLE_SAMPLING_RATE': 0,
               'SHORT_CYCLE': False,
               'SHORT_CYCLE_FACTORS': [0.5, 0.7071067811865476]},
 'MVIT': {'CLS_EMBED_ON': True,
          'DEPTH': 16,
          'DIM_MUL': [],
          'DROPOUT_RATE': 0.0,
          'DROPPATH_RATE': 0.1,
          'EMBED_DIM': 96,
          'HEAD_MUL': [],
          'MLP_RATIO': 4.0,
          'MODE': 'conv',
          'NORM': 'layernorm',
          'NORM_STEM': False,
          'NUM_HEADS': 1,
          'PATCH_2D': False,
          'PATCH_KERNEL': [3, 7, 7],
          'PATCH_PADDING': [2, 4, 4],
          'PATCH_STRIDE': [2, 4, 4],
          'POOL_FIRST': False,
          'POOL_KVQ_KERNEL': None,
          'POOL_KV_IGNORE_111_KERNEL': False,
          'POOL_KV_STRIDE': None,
          'POOL_KV_STRIDE_ADAPTIVE': None,
          'POOL_Q_STRIDE': [],
          'QKV_BIAS': True,
          'SEP_POS_EMBED': False,
          'ZERO_DECAY_POS_CLS': True},
 'NONLOCAL': {'GROUP': [[1], [1], [1], [1]],
              'INSTANTIATION': 'dot_product',
              'LOCATION': [[[]], [[]], [[]], [[]]],
              'POOL': [[[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]],
                       [[1, 2, 2], [1, 2, 2]]]},
 'NUM_GPUS': 1,
 'NUM_SHARDS': 1,
 'ORVIT': {'ADD_LAYERS': [],
           'ENABLE': False,
           'FIXED_TRAJ': False,
           'INIT_WEIGHTS': False,
           'LAYERS': [],
           'LOAD_ORVIT_ATTN_LAYERS_FROM_BB': True,
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'MOTION_STREAM_DIM': -1,
           'MOTION_STREAM_N_HEADS': 12,
           'MOTION_STREAM_SEP_POS_EMB': False,
           'O': 5,
           'USE_MOTION_STREAM': True,
           'ZERO_INIT_ORVIT': False},
 'OUTPUT_DIR': '.',
 'RESNET': {'DEPTH': 50,
            'INPLACE_RELU': True,
            'NUM_BLOCK_TEMP_KERNEL': [[3], [4], [6], [3]],
            'NUM_GROUPS': 1,
            'SPATIAL_DILATIONS': [[1], [1], [1], [1]],
            'SPATIAL_STRIDES': [[1], [2], [2], [2]],
            'STRIDE_1X1': False,
            'TRANS_FUNC': 'bottleneck_transform',
            'WIDTH_PER_GROUP': 64,
            'ZERO_INIT_FINAL_BN': False},
 'RNG_SEED': 0,
 'SHARD_ID': 0,
 'SLOTS': {'ARCH': 'steve',
           'CNN_HID_SIZE': 64,
           'DECODER': {'DIM': 2048,
                       'DROPOUT': 0.1,
                       'NUM_BLOCKS': 8,
                       'NUM_HEADS': 4,
                       'TYPE': 'mlp'},
           'DROPOUT': 0.0,
           'HARD': True,
           'HEADS': 1,
           'IMG_CHANNELS': 3,
           'IMG_SIZE': 64,
           'MLP_HID_SIZE': 1024,
           'NUM_ITERS': 3,
           'NUM_PREDICTOR_BLOCKS': 4,
           'NUM_PREDICTOR_HEADS': 8,
           'NUM_SLOTS': 3,
           'OUT_H': 8,
           'OUT_W': 14,
           'SIZE': 32,
           'SSL_TYPE': 'dino',
           'TEACHER': 'r50',
           'USE_PIXEL_RECON': False,
           'USE_SSL_FEAT': False,
           'VOCAB_SIZE': 4096},
 'SLOTS_OPTIM': {'CLIP': 1.0,
                 'DEC': 0.0004,
                 'DVAE': 0.0003,
                 'ENC': 0.0001,
                 'HALF_LIFE': 100000,
                 'STEPS': 200000,
                 'STEP_INTERVAL': 5000,
                 'TAU_FINAL': 0.1,
                 'TAU_START': 1.0,
                 'TAU_STEPS': 30000,
                 'WARMUP_STEPS': 20000},
 'SLOWFAST': {'ALPHA': 8,
              'BETA_INV': 8,
              'FUSION_CONV_CHANNEL_RATIO': 2,
              'FUSION_KERNEL_SZ': 5},
 'SOLVER': {'BASE_LR': 5e-05,
            'BASE_LR_SCALE_NUM_SHARDS': False,
            'CLIP_GRAD_L2NORM': None,
            'CLIP_GRAD_VAL': None,
            'COSINE_AFTER_WARMUP': False,
            'COSINE_END_LR': 0.0,
            'DAMPENING': 0.0,
            'GAMMA': 0.1,
            'LRS': [1, 0.1, 0.01],
            'LR_POLICY': 'steps_with_relative_lrs',
            'MAX_EPOCH': 35,
            'MOMENTUM': 0.9,
            'NESTEROV': True,
            'OPTIMIZING_METHOD': 'adam',
            'ORVIT_BASE_LR': -1.0,
            'STEPS': [0, 20, 30],
            'STEP_SIZE': 1,
            'WARMUP_EPOCHS': 0.0,
            'WARMUP_FACTOR': 0.1,
            'WARMUP_START_LR': 0.01,
            'WEIGHT_DECAY': 0.05,
            'ZERO_WD_1D_PARAM': False},
 'SPLIT_QKV_CHECKPOINT': False,
 'SSV2': {'BOXES_FORMAT': 'detectron2',
          'DATA_ROOT': '/home/gamir/DER-Roei/datasets/smthsmth',
          'SPLIT': 'standard',
          'SPLITS_ROOT': '../ORViT/data/ssv2'},
 'STEVE': {'ADD_LAYERS': [],
           'ENABLE': True,
           'INIT_WEIGHTS': False,
           'LAYERS': [1, 6, 10],
           'MOTION_STREAM_ATTN_TYPE': 'joint',
           'O': 4,
           'USE_MOTION_STREAM': True},
 'TENSORBOARD': {'CATEGORIES_PATH': '',
                 'CLASS_NAMES_PATH': '',
                 'CONFUSION_MATRIX': {'ENABLE': False,
                                      'FIGSIZE': [8, 8],
                                      'SUBSET_PATH': ''},
                 'ENABLE': True,
                 'HISTOGRAM': {'ENABLE': False,
                               'FIGSIZE': [8, 8],
                               'SUBSET_PATH': '',
                               'TOPK': 10},
                 'LOG_DIR': '',
                 'MODEL_VIS': {'ACTIVATIONS': False,
                               'COLORMAP': 'Pastel2',
                               'ENABLE': False,
                               'GRAD_CAM': {'COLORMAP': 'viridis',
                                            'ENABLE': True,
                                            'LAYER_LIST': [],
                                            'USE_TRUE_LABEL': False},
                               'INPUT_VIDEO': False,
                               'LAYER_LIST': [],
                               'MODEL_WEIGHTS': False,
                               'TOPK_PREDS': 1},
                 'PREDICTIONS_PATH': '',
                 'WRONG_PRED_VIS': {'ENABLE': False,
                                    'SUBSET_PATH': '',
                                    'TAG': 'Incorrectly classified videos.'}},
 'TEST': {'BATCH_SIZE': 64,
          'CHECKPOINT_FILE_PATH': '',
          'CHECKPOINT_TYPE': 'pytorch',
          'DATASET': 'Ssv2',
          'ENABLE': True,
          'NUM_ENSEMBLE_VIEWS': 1,
          'NUM_SPATIAL_CROPS': 1,
          'SAVE_RESULTS_PATH': '',
          'TEST_EPOCH_NUM': -1},
 'TRAIN': {'ARCH': 'slots',
           'AUTO_RESUME': False,
           'BATCH_SIZE': 4,
           'CHECKPOINT_CLEAR_NAME_PATTERN': (),
           'CHECKPOINT_EPOCH_RESET': True,
           'CHECKPOINT_FILE_PATH': None,
           'CHECKPOINT_INFLATE': False,
           'CHECKPOINT_PATH': 'checkpoints',
           'CHECKPOINT_PERIOD': 1,
           'CHECKPOINT_REPLACE_NAME_PATTERN': [],
           'CHECKPOINT_TYPE': 'pytorch',
           'DATASET': 'Cholec80',
           'ENABLE': True,
           'EVAL_PERIOD': 5,
           'LOG_INTERVAL': 2000,
           'LOG_PATH': 'logs/',
           'MIXED_PRECISION': False,
           'NUM_WORKERS': 4,
           'VAL_ONLY': False},
 'X3D': {'BN_LIN5': False,
         'BOTTLENECK_FACTOR': 1.0,
         'CHANNELWISE_3x3x3': True,
         'DEPTH_FACTOR': 1.0,
         'DIM_C1': 12,
         'DIM_C5': 2048,
         'SCALE_RES2': False,
         'WIDTH_FACTOR': 1.0}}
[06/16 16:10:09][INFO] cholec80.py:  47: Constructing Cholec80 train...
[06/16 16:10:09][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/train/1fps_100_0.pickle
[06/16 16:10:09][INFO] cholec80.py:  47: Constructing Cholec80 val...
[06/16 16:10:10][INFO] cholec80.py:  97: Cholec80 dataloader constructed (size: 50) from datasets/cholec80/labels/val/1fps.pickle
[06/16 16:10:10][DEBUG] tpu_cluster_resolver.py:  32: Falling back to TensorFlow client; we recommended you install the Cloud TPU client directly with pip install cloud-tpu-client.
[06/16 16:10:11][DEBUG] __init__.py:  72: Initializing MLIR with module: _site_initialize_0
[06/16 16:10:11][DEBUG] __init__.py:  74: Registering dialects from initializer <module 'jaxlib.mlir._mlir_libs._site_initialize_0' from '/home/ssharma/miniconda3/envs/thcu116/lib/python3.9/site-packages/jaxlib/mlir/_mlir_libs/_site_initialize_0.so'>
[06/16 16:10:11][DEBUG] path.py:  29: etils.epath found. Using etils.epath for file I/O.
[06/16 16:10:12][INFO] tensorboard_vis.py:  54: To see logged results in Tensorboard, please launch using the command             `tensorboard  --port=<port-number> --logdir ./runs-Cholec80`
[06/16 16:10:12][INFO] slot_train_net.py: 290: Start epoch: 1
[06/16 16:10:59][INFO] slot_train_net.py: 339: Epoch 0 takes 47.21s. Epochs from 0 to 0 take 47.21s in average and 47.21s in median.
[06/16 16:10:59][INFO] slot_train_net.py: 345: For epoch 0, each iteraction takes 3.93s in average. From epoch 0 to 0, each iteraction takes 3.93s in average.
[06/16 16:14:21][INFO] slot_train_net.py: 339: Epoch 1 takes 43.25s. Epochs from 0 to 1 take 45.23s in average and 45.23s in median.
[06/16 16:14:21][INFO] slot_train_net.py: 345: For epoch 1, each iteraction takes 3.60s in average. From epoch 0 to 1, each iteraction takes 3.77s in average.
[06/16 16:17:04][INFO] slot_train_net.py: 339: Epoch 2 takes 43.67s. Epochs from 0 to 2 take 44.71s in average and 43.67s in median.
[06/16 16:17:04][INFO] slot_train_net.py: 345: For epoch 2, each iteraction takes 3.64s in average. From epoch 0 to 2, each iteraction takes 3.73s in average.
